if (self.CavalryLogger) { CavalryLogger.start_js(["SFo31"]); }

__d("IasUtsClientDebuggingFalcoEvent",["FalcoLoggerInternal","getSamplingPolicyConfig_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getSamplingPolicyConfig_DO_NOT_USE")("falco","ias_uts_client_debugging");c=b("FalcoLoggerInternal").create(a);e.exports=c}),null);
__d("TimeSpentArray",["Banzai","CurrentUser","IasUtsClientDebuggingFalcoEvent","TimeSlice","clearTimeout","gkx","pageID","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){var g=2,h=g*32,i,j,k,l,m,n,o,p,q,r,s={},t;function u(){return{timeoutDelayMap:s,nextDelay:t,timeoutInSeconds:l}}function v(){if(i){var a=Date.now();a>n&&(p=Math.min(h,Math.ceil(a/1e3-m)));a=A();a&&i(a,t)}z()}function w(){x(),k=b("setTimeoutAcrossTransitions")(b("TimeSlice").guard(v,"TimeSpentArray Timeout",{propagationType:b("TimeSlice").PropagationType.ORPHAN}),l*1e3)}function x(){k&&(b("clearTimeout")(k),k=null)}function y(a){m=a;n=m*1e3;o=[1];for(var a=1;a<g;a++)o.push(0);p=1;q+=1;r+=1;a=r.toString()+"_delay";t=s[a];t===void 0&&(t=s.delay);a=r.toString()+"_timeout";a=s[a];a===void 0&&(a=s.timeout);a=Math.min(a,h);l=a||h;w()}function z(){x(),o=null}function A(){return!o?null:{tos_id:b("pageID"),start_time:m,tos_array:o.slice(0),tos_len:p,tos_seq:r,tos_cum:q}}function B(a){if(a>=n&&a-n<1e3)return;if(b("gkx")("1427308")){var c=b("CurrentUser").getID();b("IasUtsClientDebuggingFalcoEvent").log(function(){return{source:"uts",client_user_id:c,activity_time:a,last_activity_time:n}})}j&&j(a);C(Math.floor(a/1e3))}function C(a){var b=a-m;(b<0||b>=h)&&v();!o?y(a):(o[b>>5]|=1<<(b&31),p=b+1,q+=1,n=a*1e3)}e.exports={init:function(a,c,d,e){q=0,r=-1,i=a,j=e,typeof c==="object"&&c!==null?s=c:s={},y(Math.floor((d===void 0||d===null||d===0?Date.now():d)/1e3)),b("Banzai").subscribe(b("Banzai").SHUTDOWN,v)},update:function(a){B(a)},get:function(){return A()},ship:function(){v()},reset:function(){z()},testState:function(){return u()}}}),null);
__d("TimeSpentImmediateActiveSecondsLogger",["requireCond","cr:844180"],(function(a,b,c,d,e,f){"use strict";e.exports=b("cr:844180")}),null);
__d("TimeSpentBitArrayLogger",["requireCond","Arbiter","Banzai","BanzaiODS","cr:1187159","Env","LogHistory","TimeSpentArray","TimeSpentConfig","TimeSpentImmediateActiveSecondsLogger","UserActivity","WebSession","isInIframe"],(function(a,b,c,d,e,f){var g,h={delay:b("Banzai").BASIC.delay,retry:!0},i="";function j(a){a=k();a!==i&&(b("TimeSpentArray").ship(),i=a)}function k(){b("WebSession").extend();return b("WebSession").getId()}function l(a,c){a.sid_raw=i,b("Arbiter").inform("timespent/tosbitdataposted",babelHelpers["extends"]({},a)),typeof c==="number"?h.delay=c:h.delay=b("Banzai").BASIC.delay,b("Banzai").post("time_spent_bit_array",babelHelpers["extends"]({},a),h),h.delay=b("TimeSpentConfig").delay}e.exports={init:function(a){if(b("isInIframe")()&&!(g||(g=b("Env"))).isCQuick)return;if((g||(g=b("Env"))).isCQuick){b("cr:1187159")!=null?b("UserActivity").subscribe(function(a,c){b("cr:1187159").sendMessage({compatAction:"update_time_spent_bit_array_from_boc",eventTimeInMs:c.last_inform})}):b("BanzaiODS").bumpEntityKey(223,"core_metrics.time_spent.www","blue_on_comet_without_compat_broker");return}i=k();b("UserActivity").subscribe(function(a,c){a=c.last_inform;b("TimeSpentArray").update(a);b("TimeSpentImmediateActiveSecondsLogger").maybeReportActiveSecond(a)});a=Date.now();b("TimeSpentArray").init(l,b("TimeSpentConfig"),a,j);b("TimeSpentImmediateActiveSecondsLogger").maybeReportActiveSecond(a);b("BanzaiODS").bumpEntityKey(2966,"ms.time_spent.qa.www","time_spent.bits.js_initialized")}}}),null);
__d("KappaWrapper",["AsyncSignal","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){var g=!1;e.exports={forceStart:function(a,c,d){var e=0,f=function d(){new(b("AsyncSignal"))("/si/kappa/",{Ko:"a"}).send(),++e<a&&b("setTimeoutAcrossTransitions")(d,c*1e3)};b("setTimeoutAcrossTransitions")(f,(c+d)*1e3)},start:function(a,b,c){g||(g=!0,this.forceStart(a,b,c))}}}),null);
__d("ScriptPathLogger",["Banzai","CurrentUser","LogHistory","ScriptPath","URI","WebSession","isInIframe"],(function(a,b,c,d,e,f){"use strict";var g,h="script_path_change",i={scriptPath:null,categoryToken:null,extraData:{}},j=!1,k="imp_id";function l(a){var c=(g||(g=b("URI"))).getNextURI?(g||(g=b("URI"))).getNextURI():new(g||(g=b("URI")))(window.location.href),d=c.getQueryData();c=c.getPath();c.endsWith("/")&&(c=c.substr(0,c.length-1));d.comment_id&&(a.extra_data=babelHelpers["extends"]({},a.extra_data,{graphql_comment_id:d.comment_id}));var e=m(c,d);if(e){a.content_id=e;return}e=n(c);if(e!==""){a.dest_topic_feed=e;return}if(o(c)){e=d.queue_id;e&&(a.dest_srt_queue_id=e);c=d.job_in_review;c&&(a.dest_srt_reviewing_job_id=c);return}}function m(a,b){if(b.story_fbid)return b.story_fbid;if(b.fbid)return b.fbid;if(b.view==="permalink"&&b.id)return b.id;b=/\/(posts|videos|notes|groups\/.*\/permalink)\//;var c=/^[0-9]+$/;if(b.test(a)){b=a.split("/");a=b[b.length-1];if(c.test(a))return a}return""}function n(a){if(!a||a.search("/feed/topics/")==-1)return"";a=a.split("/");return a[a.length-1]}function o(a){return!!a&&a.search("/intern/review/")!==-1}function p(a,c,d,e){b("WebSession").extend();if(!j||b("isInIframe")())return;var f=b("CurrentUser").isLoggedIn(),g=f?b("Banzai").VITAL:b("Banzai").BASIC;f&&(e=e||{},e.via_banzai_vital="1");f={source_path:a.scriptPath,source_token:a.categoryToken,dest_path:c.scriptPath,dest_token:c.categoryToken,impression_id:c.extraData?c.extraData.imp_id:null,cause:d,sid_raw:b("WebSession").getId()};d=d==="unload";d||l(f);if(e!=null){var i=e;i=i.snowlift_content_id;!d&&i!=null&&(f.content_id=i,delete e.snowlift_content_id);f.extra_data=babelHelpers["extends"]({},f.extra_data,e)}a.scriptPath===null&&(f.referrer=document.referrer);d=b("ScriptPath").getClickPointInfo();d&&(f.click_point_info=d);if(a.extraData)for(var m in a.extraData)m!=k&&(f["source_"+m]=a.extraData[m]);if(c.extraData)for(var n in c.extraData)n!=k&&(f["dest_"+n]=c.extraData[n]);a.topViewEndpoint&&(f.source_endpoint=a.topViewEndpoint);c.topViewEndpoint&&(f.dest_endpoint=c.topViewEndpoint);a.restored&&(f.source_restored=!0);b("Banzai").post(h,f,g);b("ScriptPath").setClickPointInfo(null)}function q(){p(b("ScriptPath").getSourcePageInfo()||i,b("ScriptPath").getPageInfo()||i,"load")}function r(a,b,c){p(a,b,"transition",c)}function a(){p(b("ScriptPath").getPageInfo()||i,i,"unload"),b("ScriptPath").shutdown()}var s=b("ScriptPath").subscribe(function(a){if(j){var b=a.source,c=a.dest,d=a.cause;a=a.extraData;d?p(b||i,c||i,d,a):b?r(b,c||i,a):q()}});b("Banzai").subscribe(b("Banzai").SHUTDOWN,a);c={startLogging:function(){j=!0,b("ScriptPath").getPageInfo()&&q()},stopLogging:function(){j=!1,s.remove()},BANZAI_LOGGING_ROUTE:h};e.exports=c}),null);
__d("TimeSpentImmediateActiveSecondsLoggerBlue",["Banzai","ImmediateActiveSecondsConfig","ScriptPath"],(function(a,b,c,d,e,f){var g="immediate_active_seconds",h={signal:!0,retry:!0},i=b("ImmediateActiveSecondsConfig").sampling_rate,j=b("ImmediateActiveSecondsConfig").ias_bucket,k=0;function l(a){if(i<=0)return!1;a=Math.floor(a/1e3)%i;return a===j}function a(a){if(a>=k&&a-k<1e3)return;if(l(a)){var c={activity_time_ms:a,last_activity_time_ms:k,script_path:b("ScriptPath").getTopViewEndpoint()};b("Banzai").post(g,c,h)}k=Math.floor(a/1e3)*1e3}e.exports={maybeReportActiveSecond:a}}),null);